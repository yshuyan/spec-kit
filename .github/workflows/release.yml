name: Create Release

on:
  push:
    tags:
      - 'v*'

permissions:
  contents: write

jobs:
  create-release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Create release packages
        run: |
          chmod +x .github/workflows/scripts/create-release-packages.sh
          .github/workflows/scripts/create-release-packages.sh ${{ github.ref_name }}

      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          files: .genreleases/*.zip
          body: |
            ## ğŸ‰ Spec Kit Release ${{ github.ref_name }}

            ### ğŸ“¦ åŒ…å«çš„ AI Agents
            
            æ‰€æœ‰ä¸»æµ AI ç¼–ç åŠ©æ‰‹éƒ½å·²æ”¯æŒï¼š
            
            - ğŸ¤– Claude Code
            - ğŸ¤– GitHub Copilot
            - ğŸ¤– Cursor
            - ğŸ¤– Gemini CLI
            - ğŸ¤– Qwen Code
            - ğŸ¤– opencode
            - ğŸ¤– Windsurf
            - ğŸ¤– Codex CLI
            - ğŸ¤– Kilo Code
            - ğŸ¤– Auggie CLI
            - ğŸ¤– Roo Code
            
            æ¯ä¸ª agent éƒ½æœ‰ Bash (sh) å’Œ PowerShell (ps) ä¸¤ä¸ªç‰ˆæœ¬ã€‚

            ### ğŸš€ ä½¿ç”¨æ–¹æ³•

            #### åˆå§‹åŒ–æ–°é¡¹ç›®
            
            ```bash
            # ä½¿ç”¨é»˜è®¤ä»“åº“ (github/spec-kit)
            specify init my-project --ai claude
            
            # ä½¿ç”¨è‡ªå®šä¹‰ä»“åº“
            specify init my-project --ai claude --repo your-username/spec-kit
            
            # æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡
            export SPECIFY_REPO="your-username/spec-kit"
            specify init my-project --ai claude
            ```

            #### Unit Testing æ”¯æŒ
            
            ```bash
            cd my-project
            
            # åˆ›å»ºå•å…ƒæµ‹è¯•è§„èŒƒ
            /specify-unit test user authentication with validation
            
            # åˆ›å»ºæµ‹è¯•è®¡åˆ’
            /plan-unit
            
            # ç”Ÿæˆæµ‹è¯•ä»»åŠ¡
            /tasks-unit
            
            # æ‰§è¡Œæµ‹è¯•å®æ–½
            /implement-unit
            ```

            ### âœ¨ åŠŸèƒ½ç‰¹æ€§
            
            - âœ… **å®Œæ•´çš„ Spec-Driven Development å·¥ä½œæµ**
              - `/specify` - åˆ›å»ºåŠŸèƒ½è§„èŒƒ
              - `/plan` - åˆ›å»ºå®æ–½è®¡åˆ’
              - `/tasks` - ç”Ÿæˆä»»åŠ¡åˆ—è¡¨
              - `/implement` - æ‰§è¡Œå®æ–½
            
            - âœ… **Unit Testing å·¥ä½œæµ**
              - `/specify-unit` - åˆ›å»ºæµ‹è¯•è§„èŒƒ
              - `/plan-unit` - åˆ›å»ºæµ‹è¯•è®¡åˆ’
              - `/tasks-unit` - ç”Ÿæˆæµ‹è¯•ä»»åŠ¡
              - `/implement-unit` - æ‰§è¡Œæµ‹è¯•å®æ–½
            
            - âœ… **å¤šè¯­è¨€æ”¯æŒ**
              - Python, JavaScript/TypeScript, Java, Go, Swift ç­‰
              - æ”¯æŒä¸»æµæµ‹è¯•æ¡†æ¶

            ### ğŸ“š æ–‡æ¡£
            
            - [README](https://github.com/${{ github.repository }}/blob/main/README.md)
            - [Unit Testing æŒ‡å—](https://github.com/${{ github.repository }}/blob/main/UNIT-TESTING.md)
            - [Spec-Driven Development](https://github.com/${{ github.repository }}/blob/main/spec-driven.md)
            
            ---
            
            **å‘å¸ƒæ—¥æœŸ**: ${{ github.event.head_commit.timestamp }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Upload artifacts
        uses: actions/upload-artifact@v3
        with:
          name: release-packages
          path: .genreleases/*.zip
